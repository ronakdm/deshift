Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
batch_size = 8

sns.set_style("white")
fig, ax = plt.subplots(1, 1, figsize=(8, 5))

offset = 0.2
colors = ["tab:blue", "tab:orange", "tab:green"]
x = np.arange(batch_size)
for i in range(3):
    spectrum = make_superquantile_spectrum(batch_size, i + 1.0)
    ax.bar(x + i * offset, spectrum, color=colors[i], width=offset, label=f"Spectrum {i + 1}")
ax.legend(loc="upper left")
ax.set_xticks(x + offset)
ax.set_xticklabels([r"$\sigma_1$", r"$\sigma_2$", r"$\sigma_3$", r"$\sigma_4$", r"$\sigma_5$", r"$\sigma_6$", r"$\sigma_7$", r"$\sigma_8$"])
plt.show()
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mZeroDivisionError[0m                         Traceback (most recent call last)
Cell [0;32mIn[2], line 10[0m
[1;32m      8[0m x [38;5;241m=[39m np[38;5;241m.[39marange(batch_size)
[1;32m      9[0m [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m [38;5;28mrange[39m([38;5;241m3[39m):
[0;32m---> 10[0m     spectrum [38;5;241m=[39m [43mmake_superquantile_spectrum[49m[43m([49m[43mbatch_size[49m[43m,[49m[43m [49m[43mi[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[38;5;241;43m1.0[39;49m[43m)[49m
[1;32m     11[0m     ax[38;5;241m.[39mbar(x [38;5;241m+[39m i [38;5;241m*[39m offset, spectrum, color[38;5;241m=[39mcolors[i], width[38;5;241m=[39moffset, label[38;5;241m=[39m[38;5;124mf[39m[38;5;124m"[39m[38;5;124mSpectrum [39m[38;5;132;01m{[39;00mi[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;132;01m}[39;00m[38;5;124m"[39m)
[1;32m     12[0m ax[38;5;241m.[39mlegend(loc[38;5;241m=[39m[38;5;124m"[39m[38;5;124mupper left[39m[38;5;124m"[39m)

File [0;32m/opt/hostedtoolcache/Python/3.11.8/x64/lib/python3.11/site-packages/deshift/_src/spectra.py:26[0m, in [0;36mmake_superquantile_spectrum[0;34m(batch_size, tail_prob)[0m
[1;32m     24[0m spectrum [38;5;241m=[39m np[38;5;241m.[39mzeros(batch_size, dtype[38;5;241m=[39mnp[38;5;241m.[39mfloat64)
[1;32m     25[0m idx [38;5;241m=[39m math[38;5;241m.[39mfloor(batch_size [38;5;241m*[39m tail_prob)
[0;32m---> 26[0m frac [38;5;241m=[39m [38;5;241m1[39m [38;5;241m-[39m [43m([49m[43mbatch_size[49m[43m [49m[38;5;241;43m-[39;49m[43m [49m[43midx[49m[43m [49m[38;5;241;43m-[39;49m[43m [49m[38;5;241;43m1[39;49m[43m)[49m[43m [49m[38;5;241;43m/[39;49m[43m [49m[43m([49m[43mbatch_size[49m[43m [49m[38;5;241;43m*[39;49m[43m [49m[43m([49m[38;5;241;43m1[39;49m[43m [49m[38;5;241;43m-[39;49m[43m [49m[43mtail_prob[49m[43m)[49m[43m)[49m
[1;32m     27[0m [38;5;28;01mif[39;00m frac [38;5;241m>[39m [38;5;241m1e-12[39m:
[1;32m     28[0m     spectrum[idx] [38;5;241m=[39m frac

[0;31mZeroDivisionError[0m: float division by zero

